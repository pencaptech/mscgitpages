(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{1250:function(e,t,a){"use strict";a.r(t);var n=a(40),r=a(41),s=a(43),l=a(42),o=a(44),i=a(1),c=a.n(i),d=a(124),p=a(545),g=a(3),u=a(9),m=a.n(u),h=a(54),f=a.n(h),y=a(53),E=(a(576),a(577)),C=a(1210),v=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement(g.A,{hover:!0,responsive:!0},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Name"),c.a.createElement("th",null),c.a.createElement("th",null,"Sub Categories"))),c.a.createElement("tbody",null,this.props.categories.map(function(a,n){return c.a.createElement("tr",{key:a.id},c.a.createElement("td",null,n+1,". ",c.a.createElement(C.a,{to:"/".concat(e.props.typePath,"?category=").concat(a.id)},a.name)),c.a.createElement("td",null,c.a.createElement(g.b,{color:"inverse",size:"xs",onClick:function(){return e.props.editCategory(a)}},c.a.createElement("i",{className:"fa fa-edit"})),c.a.createElement(g.b,{color:"warning",size:"xs",onClick:function(){return e.props.deleteCategory(a)},disabled:a.children.length>0,title:a.children.length>0?"Can not delete category with childs":""},c.a.createElement("i",{className:"fa fa-trash"}))),c.a.createElement("td",null,c.a.createElement(g.b,{color:"success",size:"xs",onClick:function(){return e.props.addCategory(a)}},c.a.createElement("i",{className:"fa fa-plus"})," Add"),a.children.length>0&&c.a.createElement(t,{typePath:e.props.typePath,categories:a.children,addCategory:e.props.addCategory.bind(e),editCategory:e.props.editCategory.bind(e),deleteCategory:e.props.deleteCategory.bind(e)})))})))}}]),t}(c.a.Component),b=a(58),w=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={loading:!1,modal:!1,page:{number:0,size:20,totalElements:0,totalPages:0},filters:{search:""},type:"",typeName:"",typePath:"",categories:[],editFlag:!1,currentCategory:"",newCategory:{name:"",type:""},superCategory:"",addError:"",deleteError:"",updateError:""},a.updateParent=function(e,t){for(var n in e){var r=e[n];r.index=n,r.parent=t,r.children.length&&a.updateParent(r.children,r)}},a.searchUser=function(e){var t=e.target.value,n=a.state.filters;n.search=t,a.setState({filters:n},function(e){a.loadCategories()})},a.updateNewCategory=function(e){var t=a.state.newCategory;t.name=e.target.value,a.setState({newCategory:t})},a.toggleModal=function(){a.setState({modal:!a.state.modal})},a.addCategory=function(e){a.resetCategory(),a.setState({superCategory:e}),a.setState({editFlag:!1}),a.toggleModal()},a.editCategory=function(e){a.setState({newCategory:e}),a.setState({superCategory:e.parent}),a.setState({editFlag:!0}),a.toggleModal()},a.onSubmit=function(e){e.preventDefault();var t=b.i+b.d+"/api/categories/",n=a.state.newCategory;a.setState({loading:!0}),a.state.editFlag?(t+=a.state.newCategory.id,f.a.patch(t,{name:n.name}).then(function(e){if(a.toggleModal(),200===e.status){var t=a.state.categories,r=a.getChildrenArr(n,t);console.log(n),console.log(r),r[n.index]=n,a.setState({categories:t})}else a.setState({addError:e.response.data.globalErrors[0]}),m()("Unable to Edit!",e.response.data.globalErrors[0],"error")}).finally(function(){a.setState({loading:!1})})):(a.state.superCategory?(n.parentCategory=a.state.superCategory.id,n.lineage=(a.state.superCategory.lineage?a.state.superCategory.lineage:"$")+a.state.superCategory.id+"$"):n.menu=!0,n.uid=a.props.user.id,n.active=!0,f.a.post(t,n).then(function(e){if(a.toggleModal(),201===e.status){var t=a.state.categories,n=e.data;n.parent=a.state.superCategory,n.children=[];var r=a.getChildrenArr(n,t);r.unshift(e.data),r.forEach(function(e,t){e.index=t}),a.setState({categories:t})}else a.setState({addError:e.response.data.globalErrors[0]}),m()("Unable to Add!",e.response.data.globalErrors[0],"error")}).finally(function(){a.setState({loading:!1})}))},a.deleteCategory=function(e){m()({title:"Are you sure?",text:"You will not be able to recover this Category!",icon:"warning",dangerMode:!0,button:{text:"Yes, delete it!",closeModal:!0}}).then(function(t){t&&f.a.delete(b.i+b.d+"/api/categories/"+e.id).then(function(t){var n=a.state.categories,r=a.getChildrenArr(e,n);r.splice(e.index,1),r.forEach(function(e,t){e.index=t}),a.setState({categories:n})}).finally(function(){a.setState({loading:!1})}).catch(function(e){a.setState({deleteError:e.response.data.globalErrors[0]}),m()("Unable to Delete!",e.response.data.globalErrors[0],"error")})})},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"loadCategories",value:function(e){var t=this;e||(e=1);var a=b.i+b.d+"/api/categories?projection=category_all&lineage=null&sort=lineage,asc&page="+(e-1)+"&uid="+this.props.user.id;this.state.type&&(a+="&type="+this.state.type),this.state.filters.search&&(a+="&name="+encodeURIComponent("%"+this.state.filters.search+"%")),f.a.get(a).then(function(e){t.updateParent(e.data._embedded.categories,null),t.setState({categories:e.data._embedded.categories,page:e.data.page})})}},{key:"componentDidMount",value:function(){var e=this,t=this.props.match.path.substr(1);t=t.substr(0,t.indexOf("/"));var a=this.state.newCategory;a.type=t.substr(0,4);var n=t.endsWith("s")?t.substr(0,t.length-1):t;this.setState({typePath:t,type:a.type,typeName:n.charAt(0).toUpperCase()+n.slice(1),newCategory:a},function(t){e.loadCategories()})}},{key:"resetCategory",value:function(){var e={name:"",type:this.state.type};this.setState({newCategory:e})}},{key:"getIndexArr",value:function(e){for(var t=[];e.parent;)t.unshift(e.index),e=e.parent;return t.unshift(e.index),t}},{key:"getChildrenArr",value:function(e,t){var a=this.getIndexArr(e.parent),n=t;for(var r in a)n=n[a[r]].children;return n}},{key:"render",value:function(){var e=this;return c.a.createElement(p.a,null,this.state.loading&&c.a.createElement(d.a,null),c.a.createElement("style",null,".content-wrapper .btn { margin: 0 4px 4px 0 }"),c.a.createElement("div",{className:"content-heading"},this.state.typeName," Categories"),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-lg-12 col-md-12"},c.a.createElement(g.c,{className:"card-default"},c.a.createElement("div",{className:"card-header"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-md-2 offset-md-4"},c.a.createElement("h4",{className:"float-right"},"Filters : ")),c.a.createElement("div",{className:"col-md-4"},c.a.createElement(g.n,{type:"text",onChange:this.searchUser,value:this.state.filters.search,placeholder:"search category..."})),c.a.createElement("div",{className:"col-md-2"},c.a.createElement(g.b,{color:"success",size:"sm",className:"float-right",onClick:function(){return e.addCategory()}},c.a.createElement("i",{className:"fa fa-plus"}),"\xa0 Add Category")))),c.a.createElement(g.d,null,c.a.createElement(g.q,{isOpen:this.state.modal,toggle:this.toggleModal},c.a.createElement(g.t,{toggle:this.toggleModal},this.state.editFlag&&c.a.createElement("span",null,"Edit "),!this.state.editFlag&&c.a.createElement("span",null,"Add "),"Category"),c.a.createElement(g.r,null,c.a.createElement("form",{className:"form-horizontal",onSubmit:this.onSubmit},this.state.superCategory&&c.a.createElement("fieldset",null,c.a.createElement("div",{className:"form-category row mb"},c.a.createElement("label",{className:"col-md-4 col-form-label"},"Super Categories"),c.a.createElement(g.e,{md:8},c.a.createElement("h3",null,this.state.superCategory.name)))),c.a.createElement("fieldset",null,c.a.createElement("div",{className:"form-category row mb"},c.a.createElement("label",{className:"col-md-4 col-form-label"},"Name"),c.a.createElement(g.e,{md:8},c.a.createElement(g.n,{type:"text",onChange:this.updateNewCategory,maxLength:"20",value:this.state.newCategory.name,required:!0})))),c.a.createElement("fieldset",null,c.a.createElement("div",{className:"form-category row"},c.a.createElement("div",{className:"col-sm-12 text-center"},c.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Save Category"))))))),c.a.createElement(v,{typePath:this.state.typePath,categories:this.state.categories,addCategory:this.addCategory.bind(this),editCategory:this.editCategory.bind(this),deleteCategory:this.deleteCategory.bind(this)}),c.a.createElement(E.a,{page:this.state.page,onChange:function(t){return e.loadCategories(t)}}))))))}}]),t}(i.Component);t.default=Object(y.b)(function(e){return{settings:e.settings,user:e.login.userObj}})(w)},545:function(e,t,a){"use strict";var n=a(1),r=a.n(n),s=function(e){return r.a.createElement("div",{className:"content-wrapper"},e.unwrap?r.a.createElement("div",{className:"unwrap"},e.children):e.children)};s.defaultProps={unwrap:!1},t.a=s},577:function(e,t,a){"use strict";var n=a(723),r=a(40),s=a(41),l=a(43),o=a(42),i=a(44),c=a(1),d=a.n(c),p=a(614),g=a.n(p),u=a(724);function m(){var e=Object(n.a)(["\n    padding-top: 1em;\n    white-space: nowrap;\n    font-size: 16px;\n  "]);return m=function(){return e},e}function h(){var e=Object(n.a)(["\n    padding-top: 1em;\n    white-space: nowrap;\n    float: left;\n  "]);return h=function(){return e},e}function f(){var e=Object(n.a)(["\ndisplay: flex;\n-webkit-justify-content: flex-end;\njustify-content: flex-end;\nflex-direction: column;\nhite-space: nowrap;\ntext-align: right;\nmargin: 0px;\n\n"]);return f=function(){return e},e}function y(){var e=Object(n.a)(["\n    margin: 20px 10px 0;\n  "]);return y=function(){return e},e}var E=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).renderPagination=function(){var e=a.props.page.number*a.props.page.size+1,t=e+a.props.page.size-1;t>a.props.page.totalElements&&(t=a.props.page.totalElements);var n="Showing "+e+" to "+t+" of "+a.props.page.totalElements+" entries";return d.a.createElement("div",{className:"row text-center"},0===a.props.page.totalElements&&d.a.createElement("div",{className:"col-sm-12"},d.a.createElement(w,null,"No records found")),a.props.page.totalElements>0&&a.props.page.totalPages>1&&d.a.createElement("div",{className:"col-sm-12 col-md-5"},d.a.createElement(b,null,n)),a.props.page.totalElements>0&&a.props.page.totalPages>1&&d.a.createElement("div",{className:"col-sm-12 col-md-7"},d.a.createElement(v,null,d.a.createElement(g.a,{activePage:a.props.page.number+1,itemsCountPerPage:a.props.page.size,totalItemsCount:a.props.page.totalElements,pageRangeDisplayed:5,onChange:a.props.onChange,itemClass:"page-item",linkClass:"page-link",prevPageText:"<",nextPageText:">"}))))},a}return Object(i.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return d.a.createElement(C,null,d.a.createElement("style",null,"ul.pagination { white-space: nowrap; justify-content: flex-end; margin: 2px 0px; }"),this.renderPagination())}}]),t}(d.a.Component);t.a=E;var C=u.a.div(y()),v=u.a.div(f()),b=u.a.span(h()),w=u.a.span(m())}}]);
//# sourceMappingURL=24.3ea01c16.chunk.js.map